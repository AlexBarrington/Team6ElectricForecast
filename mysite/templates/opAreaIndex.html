<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by TEMPLATED
http://templated.co
Released for free under the Creative Commons Attribution License

Name       : Skeleton
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20130902

-->
{% extends "layout.html" %}
{% block statics %}
{% load staticfiles %}
<link href="{% static "css/default.css" %}" rel="stylesheet" type="text/css" media="all" />
<link href="{% static "css/fonts.css" %}" rel="stylesheet" type="text/css" media="all" />

<!--[if IE 6]><link href="default_ie6.css" rel="stylesheet" type="text/css" /><![endif]-->
{% endblock %}
		{% block content %}
<body>
   <script src="/static/js/papaparse.js"></script>

<!--   <div>
	<input type = "file" id="fileInput">
` </div> -->
  <canvas id="c" width="750" height="500"></canvas>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>
  <script>
	  
	var opArea = "{{ opArea }}"
	var url = "http://127.0.0.1:8000/data/" + opArea + "/"
	
	function doStuff(data){
		console.log("made it to the callback")
		
		var actualLoadDataSet = []
		var forecastLoadDataSet = []
		var labels = []
		//the first and last five seem to be garbage
		for(i = 5; i < data.length-5; i++){
			actualLoadDataSet.push(data[i][2]);
			forecastLoadDataSet.push(data[i][6]);
			if(i%20==0){
				labels[i] = data[i][0];
			} else{
				labels[i] = "";
			}
		}
			
		
		var ctx = document.getElementById("c").getContext("2d");
		var dataSets = {
			labels: labels,
			datasets: [{
			label: "Electric Load",
			fillColor: "rgba(220,220,220,0.2)",
			strokeColor: "rgba(220,220,220,1)",
			pointColor: "rgba(220,220,220,1)",
			pointStrokeColor: "#fff",
			pointHighlightFill: "#fff",
			pointHighlightStroke: "rgba(220,220,220,1)",
			data: actualLoadDataSet
			}, {
			label: "Temperature",
			fillColor: "rgba(151,187,205,0.2)",
			strokeColor: "rgba(151,187,205,1)",
			pointColor: "rgba(151,187,205,1)",
			pointStrokeColor: "#fff",
			pointHighlightFill: "#fff",
			pointHighlightStroke: "rgba(151,187,205,1)",
			data: forecastLoadDataSet
			}]
		};
		var MyNewChart = new Chart(ctx).Line(dataSets,{
		scaleOverride : true,
        scaleSteps : 3,
        scaleStepWidth : 50,
        scaleStartValue : 0 });
	}
	
	function parseData(url, callback){
		console.log("made it to js")
		Papa.parse(url, {
			download: true,
			dynamicTyping: true,
			complete: function(results){
				callback(results.data);
			}
		});
	}
	
	parseData(url, doStuff)
	

  </script>
</body>
		<div id="welcome">
			<div class="title">
				<h2>{{ pageTitle }}</h2>
				<span class="byline">{{ opArea }}</span>
			</div>
			<p>This is <strong>{{ opArea }}</strong>, showing the contrast between forecasted and actual electrical load</p>
			<ul class="actions">
				<li><a href="#" class="button"></a></li>
			</ul>
		</div>
		<div id="featured">
			<div class="title">
				<h2>Statistics</h2>
				<span class="byline">A quick look at how {{ opArea }} is doing</span>
			</div>
			<ul class="style1">
				<li class="first">
					<p class="date"><a href="#">Jan<b>05</b></a></p>
					<h3>Amet sed volutpat mauris</h3>
					<p><a href="#">Consectetuer adipiscing elit. Nam pede erat, porta eu, lobortis eget, tempus et, tellus. Etiam neque. Vivamus consequat lorem at nisl. Nullam non wisi a sem semper eleifend. Etiam non felis. Donec ut ante.</a></p>
				</li>
				<li>
					<p class="date"><a href="#">Jan<b>03</b></a></p>
					<h3>Sagittis diam dolor amet</h3>
					<p><a href="#">Etiam non felis. Donec ut ante. In id eros. Suspendisse lacus turpis, cursus egestas at sem. Mauris quam enim, molestie. Donec leo, vivamus fermentum nibh in augue praesent congue rutrum.</a></p>
				</li>
				<li>
					<p class="date"><a href="#">Jan<b>01</b></a></p>
					<h3>Amet sed volutpat mauris</h3>
					<p><a href="#">Consectetuer adipiscing elit. Nam pede erat, porta eu, lobortis eget, tempus et, tellus. Etiam neque. Vivamus consequat lorem at nisl. Nullam non wisi a sem semper eleifend. Etiam non felis. Donec ut ante.</a></p>
				</li>
				<li>
					<p class="date"><a href="#">Dec<b>31</b></a></p>
					<h3>Sagittis diam dolor amet</h3>
					<p><a href="#">Etiam non felis. Donec ut ante. In id eros. Suspendisse lacus turpis, cursus egestas at sem. Mauris quam enim, molestie. Donec leo, vivamus fermentum nibh in augue praesent congue rutrum.</a></p>
				</li>
			</ul>
		</div>
		{% endblock %}
		{% block copyright %}
		<div id="copyright">
			<span>&copy; Untitled. All rights reserved. | Design by <a href="http://templated.co" rel="nofollow">TEMPLATED</a>.</span>
		</div>
		{% endblock %}
	</div>
</div>
</body>
</html>
